import { memo, use, useMemo } from "react";

import { ConfigContext } from "../context/config";

export interface LaiYinProps {
  x: number;
  y: number;
  type?: "D" | "X";
}

function LaiYin({ x, y, type = "D" }: LaiYinProps) {
  const {
    laiYinFlagWidth,
    laiYinFlagHeight,
    laiYinFlagStroke,
    laiYinFlagStrokeWidth,
    laiYinFlagFill,
    laiYinFlagFontColor,
  } = use(ConfigContext);

  const daZhuanScale = (laiYinFlagWidth / 22) * 0.063;
  const xiaoZhuanScale = (laiYinFlagWidth / 22) * 0.031;

  const laiYinFontStyles = useMemo(
    () => ({
      D: (
        <g transform={`translate(3,3) scale(${daZhuanScale},${daZhuanScale})`}>
          <g transform="translate(0,0) scale(1,1)">
            <g transform="scale(1,-1) translate(0,-218)">
              <path
                stroke="none"
                fill={laiYinFlagFontColor}
                d="M123 179H126Q132 175 134 171V157Q134 153 152 151L158 145V143Q158 137 137 135Q133 135 133 116V115Q134 109 136 109Q139 109 155 120L159 121Q166 121 176 104Q190 90 190 76V73L186 72Q180 72 157 97H153L134 81V75Q134 67 142 65Q173 43 173 35Q171 31 166 29Q162 29 138 45H135L134 44L133 41H132L133 38L131 7L125 2H123Q119 4 116 12V19L117 20V21L115 23V28Q115 33 117 33L116 34V36L117 37V38L115 40V41L116 42V43L113 44L90 30Q86 34 86 38V42Q88 48 116 74L117 77Q116 82 109 84Q96 96 93 96Q89 95 88 91Q86 91 86 88Q73 70 68 70L63 69L59 73V80Q82 123 90 123L112 106H115L116 107H117L116 108V123L118 126Q118 135 110 135H109L100 134Q92 138 92 144V147Q97 153 109 153H114L118 157V174L123 179Z"
              />
            </g>
          </g>
          <g transform="translate(0,256) scale(1,1)">
            <g transform="scale(1,-1) translate(0,-218)">
              <path
                stroke="none"
                fill={laiYinFlagFontColor}
                d="M82 171L92 170L99 171L104 170L115 171L124 170L129 171L138 169L139 170H140Q180 167 187 151Q189 126 191 123Q190 117 189 117L190 110V108L189 100L190 93Q190 83 187 76L188 73Q185 53 179 41Q170 14 161 14Q160 9 129 5L124 4Q96 7 81 16Q59 36 57 49Q51 63 48 92L49 99L47 113L48 119L46 131Q46 140 51 151Q51 167 75 170L82 171ZM127 145Q127 137 142 127Q157 115 157 108L158 105Q158 101 152 98H149Q139 103 134 109L130 110Q128 110 126 97Q126 81 136 73Q140 64 152 49Q155 36 157 36Q165 36 173 83L172 84V85L174 92L173 96Q173 101 175 101L174 106V107L176 115Q174 119 174 126V135Q174 146 153 152L144 150Q139 150 139 152L136 151L132 152Q127 151 127 145ZM66 119L65 105L67 97L66 90L68 75L67 67Q72 44 81 39Q86 39 101 70Q111 82 111 109Q109 115 107 115H106Q89 101 84 101H80Q76 103 76 108Q76 119 105 135Q111 140 111 144Q111 148 107 150H91Q66 148 66 141V119ZM96 32V31Q101 25 111 22L116 23L128 22L135 23L138 22L148 28V29Q131 47 125 60Q123 60 123 63L122 64H118Q107 47 105 39L96 32Z"
              />
            </g>
          </g>
        </g>
      ),
      X: (
        <g transform={`translate(3,3) scale(${xiaoZhuanScale},${xiaoZhuanScale})`}>
          <g transform="translate(0,0) scale(1,1)">
            <g transform="scale(1,-1) translate(0,-409)">
              <path
                stroke="none"
                fill={laiYinFlagFontColor}
                d="M237 341Q237 345 237 348L236 377Q236 398 251 398Q265 397 266 375Q266 373 265 357L264 342Q316 336 352 312T389 279T389 267Q384 258 374 265L333 292Q307 309 264 315L263 219Q280 223 282 224T291 235T299 256V284Q300 288 305 291T318 291Q321 288 323 285T326 279V249Q330 234 354 224T380 209T383 202Q382 192 370 192Q346 191 314 219Q308 213 298 206T280 196T263 195Q261 189 262 185T264 181Q264 178 276 178T300 171Q311 161 318 152T330 119T337 79L340 27Q340 13 340 5T341 -28Q340 -67 326 -66Q313 -66 313 -48L312 42Q311 54 309 83T300 129T263 151V-48L264 -74Q262 -92 251 -92Q245 -93 241 -88T236 -63L235 -8V149Q215 142 210 135T202 121T198 108T195 80T190 26T187 -13T188 -37T186 -59Q178 -71 170 -64Q167 -63 164 -58T160 -34T160 38T175 129Q184 150 195 160T235 180L236 197Q231 197 229 197T226 197Q209 197 199 207T188 217Q186 216 181 211T157 197T131 190Q124 190 122 194T119 202T122 211Q123 212 138 219T159 229T169 237T175 254T177 273T176 283Q178 287 188 288Q202 288 202 268T202 247Q202 241 204 236T236 221L238 312L184 290Q170 284 151 273T127 262Q119 262 119 272Q119 278 122 284T137 296T165 311T190 324L229 338L237 341V341Z"
              />
            </g>
          </g>
          <g transform="translate(0,512) scale(1,1)">
            <g transform="scale(1,-1) translate(0,-409)">
              <path
                stroke="none"
                fill={laiYinFlagFontColor}
                d="M122 157V212L125 249L127 285Q131 325 156 341T261 358Q329 358 346 348T369 330T378 306T383 283L385 228L386 147L383 75Q380 14 366 -9T335 -42T278 -52T228 -52Q186 -49 168 -34T140 -7T129 31L124 83L122 157ZM149 164L152 86Q153 57 155 48T161 24T177 -9T266 -26Q296 -26 309 -21T336 0Q312 -7 288 44T259 110Q255 96 251 87T232 51T206 12T184 1Q177 0 174 4T171 12T175 20L204 62Q218 82 229 110T243 162L247 214V225Q225 207 219 198T209 165L203 122Q201 108 199 104T192 101Q183 101 179 108T175 122T177 151L180 180Q182 199 191 214T223 241T246 256T248 264Q248 264 248 265L245 301Q246 305 250 311T260 318Q272 319 274 299L273 266Q272 265 273 264V261V255Q302 242 315 223T333 181T338 138T334 111Q330 106 325 106Q321 105 320 106T316 110T313 124L312 155Q311 158 309 170T305 186T295 205T275 224Q274 220 274 217T275 189T278 147Q284 107 307 72L339 21L341 10L347 30L355 97L358 181L357 288Q356 309 345 316T299 327T260 330Q236 329 203 325T163 315T156 287L150 217L149 164Z"
              />
            </g>
          </g>
        </g>
      ),
    }),
    [laiYinFlagFontColor, daZhuanScale, xiaoZhuanScale],
  );

  return (
    <svg x={x} y={y} width={laiYinFlagWidth} height={laiYinFlagHeight} overflow="visible">
      <title>来因</title>
      <rect
        fill={laiYinFlagFill}
        stroke={laiYinFlagStroke}
        strokeWidth={laiYinFlagStrokeWidth}
        width={laiYinFlagWidth}
        height={laiYinFlagHeight}
      />
      {laiYinFontStyles[type]}
    </svg>
  );
}

export default memo(LaiYin);
